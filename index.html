<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bounty Hunt Calc</title>
  <link rel="icon" type="image/png" href="https://www.hunterxp.com/ico.png" sizes="32x32" />
  <meta property="og:title" content="Hunter XP Calculator">
  <meta property="og:description" content="Player level calculator for the game Hunt Showdown 1896.">
  <meta property="og:image" content="https://www.hunterxp.com/xp.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="https://www.hunterxp.com">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Hunter XP">
  <meta name="description" content="Hunter XP Calculator: A player level calculator for the game Hunt: Showdown 1896.">
  <meta name="keywords" content="Hunt Showdown, Hunt Showdown 1896, XP Calculator, Hunter XP, Bounty Hunt, Bounty Clash, Soul Survivor, Level Calculator">
  <meta name="author" content="Hunter XP">
  <meta name="robots" content="index, follow">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Hunter XP Calculator",
      "url": "https://www.hunterxp.com",
      "description": "A player level calculator for the game Hunt: Showdown 1896.",
      "image": "https://www.hunterxp.com/xp.png"
    }
  </script>
  <style>
    /* RESET / BASE */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background-color: #181716;
      color: #dcdad5;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.4;
      transition: background-color 0.3s ease, color 0.3s ease;
      text-align: center;
    }
    .container {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
    }
    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header h1 {
      font-size: 1.8rem;
      margin-bottom: 5px;
    }
    .subtitle {
      font-size: 0.9rem;
      color: #b7b3ad;
    }
    .right-links {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .coffee-btn {
      height: 40px;
      width: 130px;
    }
    .secondary-btn {
      margin-left: 10px;
      background: #2d2a26;
      padding: 6px 12px;
      color: #dcdad5;
      border-radius: 4px;
      text-decoration: none;
      border: 1px solid #3a3732;
      cursor: pointer;
    }
    /* STATS SECTION (Default Dark) */
    .stats-section {
      background-color: #201f1d;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .stats-grid h3 {
      margin-bottom: 10px;
      font-size: 1.1rem;
    }
    .item {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      justify-content: flex-start;
    }
    .item label {
      margin-right: 8px;
      font-weight: 500;
    }
    .item input[type="number"],
    .item input[type="text"],
    .item select {
      width: 60px;
      padding: 4px;
      text-align: center;
      border: 1px solid #3a3732;
      background: #2a2825;
      color: #dcdad5;
      border-radius: 4px;
    }
    .total {
      display: flex;
      justify-content: flex-end;
      margin-top: 10px;
      gap: 20px;
    }
    .total .column {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 5px;
    }
    .total button {
      padding: 6px 10px;
      background: #7c775e;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .total span {
      font-size: 1.1rem;
    }
    /* CONTROLS SECTION (Default Dark) */
    .controls-section {
      margin-bottom: 20px;
      background-color: #201f1d;
      padding: 15px;
      border-radius: 8px;
    }
    .controls-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }
    .controls-grid .item {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }
    .controls-grid .item button {
      padding: 4px 8px;
      margin: 0 4px;
      background: #7c775e;
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
    }
    .controls-grid .item input[type="checkbox"] {
      margin-right: 6px;
    }
    /* CREATURE SECTION (Default Dark) */
    .creatures-section {
      background-color: #201f1d;
      padding: 15px;
      border-radius: 8px;
    }
    .creatures-section h3 {
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .creatures-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      justify-items: center;
    }
    .creatures-grid .item {
      background-color: #2a2825;
      border-radius: 4px;
      padding: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    .creatures-grid .controls-line {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 4px;
    }
    .creatures-grid .controls-line button {
      padding: 6px 8px;
      background: #7c775e;
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
    }
    .creatures-grid .controls-line input[type="number"] {
      width: 50px;
      text-align: center;
      background: #2a2825;
      border: 1px solid #3a3732;
      color: #dcdad5;
      border-radius: 4px;
    }
    .creatures-grid .creature-label {
      font-size: 0.9rem;
    }
    /* FOOTER (Default Dark) */
    .footer {
      margin-top: 30px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .footer p {
      font-size: 0.9rem;
      color: #b7b3ad;
    }
    .moon-btn {
      padding: 8px 14px;
      background: #7c775e;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    /* TOOLTIP STYLES */
    .tooltip-trigger {
      position: relative;
      cursor: pointer;
    }
    .tooltip-content {
      display: none;
      position: absolute;
      top: 120%;
      left: 0;
      background-color: #000000cc;
      color: #fff;
      padding: 6px 8px;
      border-radius: 4px;
      font-size: 0.9em;
      white-space: nowrap;
      z-index: 999;
    }
    .tooltip-trigger:hover .tooltip-content {
      display: block;
    }
    sup {
      font-size: smaller;
      vertical-align: super;
    }
    /* 2ND THEME ("light") */
    .light {
      background: #2c2a28;
      color: #e2e0dc;
    }
    .light .stats-section,
    .light .controls-section,
    .light .creatures-section {
      background-color: #3b3937;
    }
    .light .item input[type="number"],
    .light .item input[type="text"],
    .light .item select {
      background: #4a4744;
      color: #e2e0dc;
      border: 1px solid #605e5b;
    }
    .light .creatures-grid .item {
      background-color: #4a4744;
      color: #e2e0dc;
      border: 1px solid #605e5b;
    }
    .light .total button,
    .light .controls-grid .item button,
    .light .moon-btn {
      background: #726e68;
    }
    /* 3RD THEME ("genuineLight") */
    .genuineLight {
      background: #f2f2f2;
      color: #2c2c2c;
    }
    .genuineLight .stats-section,
    .genuineLight .controls-section,
    .genuineLight .creatures-section {
      background-color: #ffffff;
    }
    .genuineLight .item input[type="number"],
    .genuineLight .item input[type="text"],
    .genuineLight .item select {
      background: #e9ecef;
      color: #2c2c2c;
      border: 1px solid #ccc;
    }
    .genuineLight .creatures-grid .item {
      background-color: #f8f9fa;
      color: #2c2c2c;
      border: 1px solid #ddd;
    }
    .genuineLight .total button,
    .genuineLight .controls-grid .item button,
    .genuineLight .moon-btn {
      background: #999;
      color: #fff;
    }
    @media (max-width: 700px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .controls-grid {
        grid-template-columns: 1fr;
      }
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
    /* FAQ Modal Styles */
    .faq-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }
    .faq-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      position: relative;
      border-radius: 8px;
      text-align: left;
      color: #000;
    }
    .faq-close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    .faq-close:hover,
    .faq-close:focus {
      color: black;
      text-decoration: none;
    }
    body:not(.light):not(.genuineLight) .faq-content {
      background-color: #201f1d;
      color: #dcdad5;
      border: 1px solid #3a3732;
    }
    body.light .faq-content {
      background-color: #3b3937;
      color: #e2e0dc;
      border: 1px solid #605e5b;
    }
    body.genuineLight .faq-content {
      background-color: #ffffff;
      color: #2c2c2c;
      border: 1px solid #ddd;
    }
    .genuineLight .secondary-btn {
      color: #dcdad5;
    }
    a:visited {
      color: inherit;
    }
	.new-badge {
	  display: inline-block;
	  background-color: red;
	  color: white;
	  border-radius: 4px;
	  padding: 2px 6px;
	  font-size: 0.75em;
	  font-weight: bold;
	  box-shadow: 0 0 3px rgba(255, 0, 0, 0.8);
	  margin-left: 4px;
	}
	.beta-badge {
	  display: inline-block;
	  background-color: orange;
	  color: white;
	  border-radius: 4px;
	  padding: 2px 6px;
	  font-size: 0.75em;
	  font-weight: bold;
	  margin-left: 4px;
	}
    /* Mobile Browser Adjustments:
       When a mobile browser is detected, make the font very small
       for everything in the second section (Controls Section)
    */
    body.mobile .controls-section,
    body.mobile .controls-section * {
      font-size: 10px !important;
    }
    /* Mobile Browser Adjustments for PVP and Monster Kills Section */
    body.mobile .creatures-section .item {
      border-width: 0.5px !important;
      padding: 4px !important;
    }
    body.mobile .creatures-section .controls-line button {
      padding: 2px 4px !important;
      font-size: 0.7rem !important;
    }
    body.mobile .creatures-section .controls-line input[type="number"] {
      width: 30px !important;
      font-size: 0.7rem !important;
      padding: 2px !important;
    }
    body.mobile .creatures-section .creature-label {
      font-size: 0.7rem !important;
    }
  </style>
  <script>
    // Detect mobile browsers based on user agent and add a "mobile" class to the body
    if (/Mobi|Android/i.test(navigator.userAgent)) {
      document.addEventListener("DOMContentLoaded", function() {
        document.body.classList.add("mobile");
      });
    }
  </script>
</head>
<body class="light" onload="resetFields()">
  <div class="container">
    <!-- HEADER -->
    <div class="header">
      <div>
        <h1>Bounty Hunt Calculator</h1>
        <p class="subtitle">Last updated 02/27/2025
          &nbsp;&nbsp;<sup class="tooltip-trigger"><svg width="16" height="16"><use xlink:href="#chat-left-text"></use></svg>
            <span class="tooltip-content">
			  <b>Known Issues:</b><br>• XP ranges for levels slightly<br>out of sync due to no published numbers by Crytek.<br><br>
              <b>Changelog:</b><br>• Added "Start At Level" feature <span class="beta-badge">BETA</span><span class="new-badge">NEW!</span><br><br>
			  • Pressing R on keyboard now resets all fields <span class="new-badge">NEW!</span><br><br>
			  • Refined math on Extraction Time Remaining<br><br>
              • Increased Clean Sweep max to 2<br><br>
              • Changed 250 Bloodline XP milestone from<br>
                Level 9 to 8 (UI shows 9 in-game, but<br>
                awards on 8 due to bug?)<br><br>
              • Renamed Bounty Tokens Extracted to<br>Boss Bounty Tokens Extracted<br><br>
              • Added Event Bounty Tokens Extracted<br><br>
              • Added Event Hunter XP Envelopes<br><br>
              • Limited envelope maximum to 50<br><br>
              • XP To Next Level now shows only <br>1 digit after decimal<br>
            </span>
          </sup>
        </p>
      </div>
      <div class="right-links">
        <a href="/" class="secondary-btn"><i>Bounty Hunt</i></a>
        <a href="/bountyclash/" class="secondary-btn">Bounty Clash</a>
        <a href="/soulsurvivor/" class="secondary-btn">Soul Survivor</a>
        <button id="faqButton" class="secondary-btn">FAQ</button>
        <a href="https://www.buymeacoffee.com/jgdf42" target="_blank">
          <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"
               alt="Buy Me A Coffee"
               class="coffee-btn">
        </a>
      </div>
    </div>

    <!-- Tooltip Icon -->
    <svg style="display: none;">
      <defs>
        <symbol id="question-icon" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
          <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"/>
        </symbol> 
        <symbol id="chat-left-text" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
          <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
        </symbol>
      </defs>
    </svg>

    <!-- STATS SECTION -->
    <section class="stats-section">
      <div class="stats-grid">
        <div>
          <h3>Bloodline Rank Calculator:<sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
            <span class="tooltip-content">These three values are for reference<br>and are not affected by any inputs.</span>
          </sup></h3>
          <div class="item">
            <label>Bloodline Rank:</label>
            <input type="number" id="bloodlineRank" value="1" min="1" max="100" oninput="updateBloodlineXP()">
          </div>
          <div class="item">
            <label>Estimated Bloodline XP:</label>
            <span id="estimatedBloodlineXP">0</span>
          </div>
          <div class="item">
            <label>XP To Bloodline Rank 100:</label>
            <span id="xpToRank100">0</span>
          </div>
        </div>
        <div>
          <h3>XP Earned This Match:<sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
            <span class="tooltip-content">To determine Prestige eligibility,<br>compare "<u>Bonus Bloodline XP:</u>"<br>with <u>"XP To Bloodline Rank 100:"</u></span>
          </sup></h3>
          <div class="item">
            <label>Bonus Bloodline XP:</label>
            <span id="bonusBloodlineXP">0</span>
          </div>
          <div class="item">
            <label>Estimated Hunter Level:</label>
            <span id="estimatedLevel">1</span>
          </div>
          <div class="item">
            <label>XP to Next Level:</label>
            <span id="xpToNextLevel">100</span>
          </div>
          <div class="item">
            <label>XP to Level 50:</label>
            <span id="xpRemaining">21100</span>
          </div>
          <!-- New dropdown for Start Match at Level -->
          <div class="item">
            <label>Start Match at Level:</label>
            <select id="startMatchLevel" onchange="handleStartMatchLevelChange()">
              <!-- Options 1 through 50 -->
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="23">23</option>
              <option value="24">24</option>
              <option value="25">25</option>
              <option value="26">26</option>
              <option value="27">27</option>
              <option value="28">28</option>
              <option value="29">29</option>
              <option value="30">30</option>
              <option value="31">31</option>
              <option value="32">32</option>
              <option value="33">33</option>
              <option value="34">34</option>
              <option value="35">35</option>
              <option value="36">36</option>
              <option value="37">37</option>
              <option value="38">38</option>
              <option value="39">39</option>
              <option value="40">40</option>
              <option value="41">41</option>
              <option value="42">42</option>
              <option value="43">43</option>
              <option value="44">44</option>
              <option value="45">45</option>
              <option value="46">46</option>
              <option value="47">47</option>
              <option value="48">48</option>
              <option value="49">49</option>
              <option value="50">50</option>
            </select>
          </div>
        </div>
      </div>
<div class="total">
  <div class="column">
    <div class="tooltip-trigger" style="display:inline-block;">
      <button onclick="resetFields()"><u>R</u>eset</button>
      <span class="tooltip-content" style="font-size:0.8rem;">Tip: You can press R to reset</span>
    </div>
    <span>Total XP: <strong id="totalXP">0</strong></span>
  </div>
</div>
    </section>

    <!-- CONTROLS SECTION -->
    <section class="controls-section">
      <div class="controls-grid">
        <!-- LEFT COLUMN -->
        <div>
          <div class="item">
            <label for="prestigeBoost">Current Prestige</label>
            <input type="number" id="prestigeBoost" min="1" max="100" oninput="updatePrestigeBoost(); updateTotal();" style="width:60px;">
            &nbsp;&nbsp;<sup class="tooltip-trigger"><svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">
                10% XP Boost starts at prestige 21<br>
                and then occurs at every level<br>
                except those ending in 0 or 5.<br>
                <b>Example:</b><br>
                21, 22, 23, 24, 26, 27, 28, 29
              </span>
            </sup>
            <span id="prestigeBoostIndicator"></span>
          </div>
          <div class="item">
            <input type="checkbox" id="dailyExtractBoost" onchange="updateTotal()">
            <label>First Daily Extract (+15%)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">Each hunter in your roster can<br>perform this action once per day.<br><b>Accolades:</b><p>First Bounty Extraction</span>
            </sup>
          </div>
          <div class="item">
            <input type="checkbox" id="startingLevel50" onchange="handleStartingLevel50()">
            <label>Starting Match As Level 50</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">If enabled, all XP earned this match<br>goes directly into Bonus Bloodline XP</span>
            </sup>
          </div>
          <div class="item">
            <input type="checkbox" id="deathPenalty" onchange="handleDeathPenalty()">
            <label>Death (½ XP to Bloodline)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">
                Bonus Bloodline XP awarded for Level milestones<br>
                during the match are awarded on death in full;<br>
                Level 4 (250), 8 (250), 13 (250), 19 (500),<br>26 (500), 34 (500), 42 (750), 50 (1000)<br><b>NOTE: Do not use if you have Death Cheat trait.</b>
              </span>
            </sup>
          </div>
          <div class="item">
            <input type="checkbox" data-xp="1200" id="soloDuo" onchange="updateTotal(); soloselection(this); updateReviveKillState();">
            <label>Extract with Bounty in Solo VS Duo (1200 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content"><b>Contract Bonus</b><p>Requires at least<br>1 Bounty Token extracted</span>
            </sup>
          </div>
          <div class="item">
            <input type="checkbox" data-xp="2400" id="soloTrio" onchange="updateTotal(); soloselection(this); updateReviveKillState();">
            <label>Extract with Bounty in Solo VS Trio (2400 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content"><b>Contract Bonus</b><p>Requires at least<br>1 Bounty Token extracted</span>
            </sup>
          </div>
          <div class="item">
            <input type="checkbox" data-xp="600"  id="duoTrio" onchange="updateTotal(); soloselection(this); updateReviveKillState();">
            <label>Extract with Bounty in Duo VS Trio (600 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content"><b>Contract Bonus</b><p>Requires at least<br>1 Bounty Token extracted</span>
            </sup>
          </div>
          <div class="item">
            <label>Extraction Time Remaining With Bounty:</label>
            <input type="text" id="extractionTime" placeholder="mm:ss" maxlength="5" oninput="validateExtractionTime(this)">
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">Match time remaining,<br>requires at least 1 Bounty Token extracted.<p><b>Example:</b><p>23:05</span>
            </sup>
          </div>
          <br>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="eventEnvelopeXP" placeholder="#" oninput="updateTotal()" maxlength="2" max="50">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Event Hunter XP Envelopes (2000 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;
              <svg width="16" height="16">
                <use xlink:href="#question-icon"></use>
              </svg>
              <span class="tooltip-content">
                Event Hunter XP Envelopes are worth<br>
                more than standard Hunter XP Envelopes.
              </span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="eventBounty" placeholder="#" value="0" min="0" max="1" oninput="handleEventBountyInput(); updateTotal()">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Event Bounty Tokens Extracted (400 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;
              <svg width="16" height="16">
                <use xlink:href="#question-icon"></use>
              </svg>
              <span class="tooltip-content">
                If Event Bounty is present,<br>
                only 2 Boss Bounty tokens<br>
                will be available for extract.
              </span>
            </sup>
          </div>  
        </div>

        <!-- RIGHT COLUMN -->
        <div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="cluepickups" placeholder="#" min="0" max="6" oninput="updateTotal(); validateClueInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Clues Found (200 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">If first clue collected is Boss,<br>only count one clue for that bounty.</span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="lairpickups" placeholder="#" min="0" max="2" oninput="updateTotal(); validateLairInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Lairs Discovered (100 XP)</label>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="bosskills" placeholder="#" min="0" max="2" oninput="updateTotal(); validateBossInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Boss Kills [Team Queue] (400 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content"><b>Accolades:</b><br>Killed (100 BP)</span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="solobosskills" placeholder="#" min="0" max="2" oninput="updateTotal(); validatesoloBossInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Boss Kills [Solo Queue] (800 XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content"><b>Accolades:</b><br>Solo Kill Bonus (100 BP)<br>Killed (100 BP)</span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="Tokenpickups" placeholder="#" min="0" max="4" oninput="updateTotal(); validateTokenInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Boss Bounty Tokens Extracted (500 XP)</label>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="banishpickups" placeholder="#" min="0" max="2" oninput="updateTotal(); validateBanishInput();">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Boss Banishes (350 XP)</label>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" data-xp="100" id="cleanSweep" value="0" placeholder="#" min="0" max="2" oninput="validateCleanSweep(); updateTotal()">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Clean Sweep (100 XP)</label>
            <sup class="tooltip-trigger">
              &nbsp;&nbsp;<svg width="16" height="16">
                <use xlink:href="#question-icon"></use>
              </svg>
              <span class="tooltip-content">Kill, Banish and Extract<br><b>NOTE:</b><br>Cannot Clean Sweep with Hellborn,<br>due to lack of Banish.</span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="envelopeXP" placeholder="#" maxlength="2" min="0" max="50" oninput="updateTotal()">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Hunter XP Envelopes (1000 XP)</label>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="bloodlineEnvelopeXP" placeholder="#" maxlength="2" min="0" max="50" oninput="updateTotal()">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Bloodline XP Envelopes (500 BL XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">Envelopes are unaffected by<br>death penalty XP reduction.</span>
            </sup>
          </div>
          <div class="item">
            <button onclick="adjustCount(this, -1)">-</button>
            <input type="number" id="retireLevel50" placeholder="#" maxlength="3" min="0" max="100" oninput="updateTotal()">
            <button onclick="adjustCount(this, 1)">+</button>
            <label>Retire a Level 50 (10000 BL XP)</label>
            <sup class="tooltip-trigger">&nbsp;&nbsp;<svg width="16" height="16"><use xlink:href="#question-icon"></use></svg>
              <span class="tooltip-content">Retiring a Level 50 Hunter at <br><b>Bloodline Rank 92</b><br>should level you to Rank 100 Prestige.</span>
            </sup>
          </div>
        </div>
      </div>
    </section>

    <!-- CREATURES SECTION -->
    <section class="creatures-section">
      <h3>PVP and Monster Kills</h3>
      <div id="creatures" class="creatures-grid">
        <!-- Dynamically appended by JS -->
      </div>
    </section>

    <!-- FOOTER -->
    <div class="footer">
      <button class="moon-btn" onclick="tdnn()">Toggle Theme</button>
    </div>
  </div>

  <!-- FAQ Modal -->
  <div id="faqModal" class="faq-modal">
    <div class="faq-content">
      <span id="faqClose" class="faq-close">&times;</span>
      <h2>Frequently Asked Questions</h2><br>
      <p><strong>Q:</strong> What is this?</p>
      <p><strong>A:</strong> A way to calculate progression in Hunt: Showdown 1896.</p><br>
      <p><strong>Q:</strong> What are some of the features?</p>
      <p><strong>A:</strong> Some quality of life features include;</p>
      <p>• Adds bonus bloodline XP at key hunter level milestones.</p>
      <p>• Credits all XP earned after reaching level 50 to your bloodline.</p>
      <p>• Applies a 10% boost for valid Prestige levels.</p><br>
      <p><strong>Q:</strong> How do I reset the fields?</p>
      <p><strong>A:</strong> Click the "Reset" button to clear all inputs.</p><br>
      <p><strong>Q:</strong> What doesn't this calculate?</p>
      <p><strong>A:</strong> Hunt dollars and weapon XP. Dark Tribute Bonus XP also isn't factored - this can be claimed 4 times daily at the main menu.</p><br>
      <p><strong>Q:</strong> I found a bug or error.</p>
      <p><strong>A:</strong> You can reach me at:</p> 
      <p>
        <a href="https://www.reddit.com/user/SopranoConcertina/" target="_blank">
          <img src="https://www.redditstatic.com/desktop2x/img/favicon/android-icon-192x192.png" alt="Reddit" style="height:16px; vertical-align:middle; margin-right:4px;">SopranoConcertina
        </a>
        or on 
        <a href="http://discordapp.com/users/658685123549593601" target="_blank">
          <img src="https://i.imgur.com/hIxR9DX.png" alt="Discord" style="height:16px; vertical-align:middle; margin-right:4px;">anthonyjsoprano
        </a>
      </p><br>
      <p><strong>Q:</strong> Can I buy you a coffee?</p>
      <p><strong>A:</strong> Absolutely -- coffee fuels creativity! I've dedicated many hours to building this calculator for fellow Hunters, and every little bit helps keep it updated and ready for future events. <p>If you'd like to support my work or if this helped you, consider buying me a coffee:
      <a href="https://www.buymeacoffee.com/jgdf42" target="_blank">
      <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height:24px; vertical-align:middle; margin-left:4px;">
      </a> <br>Thanks a bunch, see you on the bayou!</p><br>
      <br><h5>Special thanks: Bious, Richkan</h5>
    </div>
  </div>

  <!-- JAVASCRIPT -->
  <script>
    /* Global XP Tables */
    const bloodlineXPTable = [
      0, 250, 750, 1300, 1800, 2300, 2800, 3300, 3800, 4300,
      4800, 5300, 5800, 6300, 6800, 7300, 7800, 8300, 8800, 9300,
      9800, 10300, 10800, 11300, 11800, 12300, 12800, 13300, 13800, 14300,
      14800, 15300, 15800, 16800, 17800, 18800, 19800, 20800, 21800, 22800,
      23800, 24800, 25800, 26800, 27800, 28800, 29800, 30800, 31800, 32800,
      33800, 34800, 35800, 36800, 37800, 38800, 39800, 40800, 41800, 42800,
      43800, 44800, 45800, 46800, 47800, 48800, 50300, 51800, 53300, 54800,
      56300, 57800, 59300, 60800, 62300, 63800, 65300, 66800, 68300, 69800,
      71300, 72800, 74300, 75800, 77300, 78800, 80300, 81800, 83300, 84800,
      86300, 87800, 89300, 90800, 92300, 93800, 95300, 96800, 98300, 99800,
      99800
    ];
    
    // XP table for hunter levels (levels 1–50)
    const xpTable = [
      0, 100, 200, 400, 600, 800, 1000, 1300, 1600, 1900,
      2200, 2500, 2800, 3100, 3400, 3700, 4000, 4300, 4700, 5100,
      5500, 5900, 6300, 6700, 7100, 7600, 8100, 8600, 9100, 9600,
      10100, 10600, 11100, 11600, 12100, 12700, 13300, 13900, 14500, 15100,
      15700, 16300, 16900, 17500, 18100, 18700, 19300, 19900, 20500, 21100
    ];
    
    /* 1. Bloodline XP Update */
    function updateBloodlineXP() {
      let rank = parseInt(document.getElementById("bloodlineRank").value) || 1;
      if (rank > 100) {
        rank = 1;
      } else {
        rank = Math.max(1, rank);
      }
      document.getElementById("bloodlineRank").value = rank;
      let bloodlineXP = bloodlineXPTable[rank - 1];
      document.getElementById("estimatedBloodlineXP").textContent = bloodlineXP;
      let xpToRank100 = 99800 - bloodlineXP;
      document.getElementById("xpToRank100").textContent = Math.max(0, xpToRank100);
      updateTotal();
    }
    
    /* 2. Creature Array & Insertion */
    const creatures = {
      "&nbsp;Kill Hunter": 450,
      "&nbsp;Revive Partner": 100,
      "&nbsp;Kill Teammate": -500,
      "&nbsp;Grunt": 20,
      "&nbsp;Hellhound": 40,
      "&nbsp;Hive": 60,
      "&nbsp;Immolator": 60,
      "&nbsp;Armoured": 60,
      "&nbsp;Meathead/Brute": 300,
      "&nbsp;Waterdevil": 20,
      "&nbsp;Leech": 10
    };
    let creatureContainer = document.getElementById("creatures");
    for (let [name, xp] of Object.entries(creatures)) {
      let div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <div class="controls-line">
          <button onclick="adjustCount(this, -1)">-</button>
          <input type="number" value="0" min="0" data-xp="${xp}" onchange="updateTotal()">
          <button onclick="adjustCount(this, 1)">+</button>
        </div>
        <div class="creature-label">${name} (${xp} XP)</div>
      `;
      creatureContainer.appendChild(div);
    }
    
    /* 3. Adjust Count for Plus/Minus Buttons */
    function adjustCount(button, change) {
      let input = button.parentElement.querySelector("input");
      let min = parseInt(input.min) || 0;
      let max = parseInt(input.max) || Infinity;
      let newValue = Math.min(max, Math.max(min, parseInt(input.value) + change));
      input.value = newValue;
      if (input.id === "Tokenpickups") {
        input.dispatchEvent(new Event('input'));
      }
      if (input.id === "bosskills" && newValue > 0) {
        document.getElementById("solobosskills").value = 0;
      } else if (input.id === "solobosskills" && newValue > 0) {
        document.getElementById("bosskills").value = 0;
      }
      updateTotal();
    }
    
    /* 4. Validate Extraction Time */
    let updateTotalTimeout;
    function validateExtractionTime(input) {
      const currentValue = input.value;
      const sanitizedValue = currentValue.replace(/[^0-9:]/g, '');
      input.value = sanitizedValue;
      const isValidPartial = /^([0-5]?[0-9]:?)?([0-5]?[0-9])?$/.test(sanitizedValue);
      if (!isValidPartial) {
        input.value = input.dataset.previousValidValue || "";
      } else {
        input.dataset.previousValidValue = sanitizedValue;
      }
      clearTimeout(updateTotalTimeout);
      updateTotalTimeout = setTimeout(updateTotal, 200);
    }
    
    /* 5. Validate Other Inputs */
    function validateClueInput() {
      let cluepickupsInput = document.getElementById("cluepickups");
      let value = parseInt(cluepickupsInput.value) || 0;
      if (value > 6) {
        cluepickupsInput.value = 6;
      } else if (value < 0) {
        cluepickupsInput.value = 0;
      }
      updateTotal();
    }
    function validateLairInput() {
      let lairpickupsInput = document.getElementById("lairpickups");
      let value = parseInt(lairpickupsInput.value) || 0;
      if (value > 2) lairpickupsInput.value = 2;
      else if (value < 0) {
        lairpickupsInput.value = 0;
      }
      updateTotal();
    }
    function validateBanishInput() {
      let banishpickupsInput = document.getElementById("banishpickups");
      let value = parseInt(banishpickupsInput.value) || 0;
      if (value > 2) banishpickupsInput.value = 2;
      else if (value < 0) {
        banishpickupsInput.value = 0;
      }
      updateTotal();
    }
    function validateTokenInput() {
      let tokenInput = document.getElementById("Tokenpickups");
      let value = parseInt(tokenInput.value) || 0;
      if (value > 4) {
        tokenInput.value = 4;
      } else if (value < 0) {
        tokenInput.value = 0;
      }
      updateExtractionTimeState();
      updateTotal();
    }
    function validateBossInput() {
      let bosskillsInput = document.getElementById("bosskills");
      let solobosskillsInput = document.getElementById("solobosskills");
      let value = parseInt(bosskillsInput.value) || 0;
      if (value > 2) bosskillsInput.value = 2;
      if (value > 0) {
        solobosskillsInput.value = 0;
      }
      updateTotal();
    }
    function validatesoloBossInput() {
      let bosskillsInput = document.getElementById("bosskills");
      let solobosskillsInput = document.getElementById("solobosskills");
      let value = parseInt(solobosskillsInput.value) || 0;
      if (value > 2) {
        solobosskillsInput.value = 2;
      }
      if (value > 0) {
        bosskillsInput.value = 0;
      }
      updateTotal();
    }
    
    /* 6. Death Penalty & Starting Level 50 */
    function handleDeathPenalty() {
      const deathPenaltyCheckbox = document.getElementById("deathPenalty");
      const startingLevel50 = document.getElementById("startingLevel50");
      const otherCheckboxes = [
        "dailyExtractBoost", "soloDuo", "soloTrio", "duoTrio", "cleanSweep",
        "Tokenpickups"
      ];
      let eventBountyInput = document.getElementById("eventBounty");
      let eventBountyButtons = eventBountyInput.parentElement.querySelectorAll("button");
      if (deathPenaltyCheckbox.checked) {
        disableElements(otherCheckboxes);
        startingLevel50.checked = false;
        startingLevel50.disabled = true;
        eventBountyInput.value = 0;
        eventBountyInput.disabled = true;
        eventBountyButtons.forEach(btn => btn.disabled = true);
      } else {
        enableElements(otherCheckboxes);
        startingLevel50.disabled = false;
        eventBountyInput.disabled = false;
        eventBountyButtons.forEach(btn => btn.disabled = false);
      }
      updateExtractionTimeState();
      updateTotal();
    }
    function handleStartingLevel50() {
      const startingLevel50Checkbox = document.getElementById("startingLevel50");
      if (startingLevel50Checkbox.checked) {
        document.getElementById("startMatchLevel").value = 50;
      } else {
        document.getElementById("startMatchLevel").value = 1;
      }
      updateTotal();
    }
    function disableElements(elements) {
      elements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          if (element.type === "checkbox") {
            element.checked = false;
          } else if (element.type === "text" || element.type === "number") {
            element.value = 0;
            disableButtons(element);
          }
          element.disabled = true;
        }
      });
    }
    function enableElements(elements) {
      elements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.disabled = false;
          if (element.type === "number") {
            enableButtons(element);
          }
        }
      });
    }
    function disableButtons(element) {
      const buttons = element.parentElement.querySelectorAll("button");
      buttons.forEach(button => button.disabled = true);
    }
    function enableButtons(element) {
      const buttons = element.parentElement.querySelectorAll("button");
      buttons.forEach(button => button.disabled = false);
    }
    
    /* 7. Solo Selection */
    function soloselection(currentCheckbox) {
      const checkboxes = ["soloDuo", "soloTrio", "duoTrio"];
      checkboxes.forEach(id => {
        if (currentCheckbox.id !== id) {
          document.getElementById(id).checked = false;
        }
      });
      updateTotal();
    }
    function updateReviveKillState() {
      const soloDuoChecked = document.getElementById("soloDuo").checked;
      const soloTrioChecked = document.getElementById("soloTrio").checked;
      const disableReviveAndKill = soloDuoChecked || soloTrioChecked;
      document.querySelectorAll("#creatures .item").forEach(item => {
        const label = item.querySelector(".creature-label");
        if (
          label &&
          (label.textContent.includes("Revive Partner") || label.textContent.includes("Kill Teammate"))
        ) {
          const input = item.querySelector("input[type='number']");
          if (disableReviveAndKill) {
            input.value = 0;
            input.disabled = true;
            disableButtons(input);
          } else {
            input.disabled = false;
            enableButtons(input);
          }
        }
      });
    }
    
    /* 8. Event Bounty Limiter */
    function handleEventBountyInput() {
      const eventBountyInput = document.getElementById("eventBounty");
      let value = parseInt(eventBountyInput.value) || 0;
      if (value > 1) {
        eventBountyInput.value = 1;
        value = 1;
      }
      const tokenInput = document.getElementById("Tokenpickups");
      let tokenValue = parseInt(tokenInput.value) || 0;
      if (value === 1 && tokenValue > 1) {
        tokenInput.value = 1;
      }
    }
    
    /* 9. New: Handle Start Match Level Dropdown Change */
    function handleStartMatchLevelChange() {
      let startLevel = parseInt(document.getElementById("startMatchLevel").value) || 1;
      if (startLevel === 50) {
        document.getElementById("startingLevel50").checked = true;
      } else {
        document.getElementById("startingLevel50").checked = false;
      }
      updateTotal();
    }
    
    /* 10. Updated Total & Progress Calculation */
    function updateTotal() {
      let sessionXP = 0;
      let multiplier = 1;
      var p = parseInt(document.getElementById("prestigeBoost").value);
      if (!isNaN(p) && isPrestigeValid(p)) {
        multiplier += 0.1;
      }
      if (document.getElementById("dailyExtractBoost").checked) multiplier += 0.15;
      
      document.querySelectorAll("input[type='checkbox'][data-xp]:checked").forEach(cb => {
        sessionXP += parseInt(cb.getAttribute("data-xp")) * multiplier;
      });
      document.querySelectorAll("input[type='number'][data-xp]").forEach(input => {
        let xp = (parseInt(input.value) || 0) * parseInt(input.getAttribute("data-xp"));
        sessionXP += xp * multiplier;
      });
      let cluepickups = parseInt(document.getElementById("cluepickups").value) || 0;
      sessionXP += cluepickups * 200 * multiplier;
      let lairpickups = parseInt(document.getElementById("lairpickups").value) || 0;
      sessionXP += lairpickups * 100 * multiplier;
      let bosskills = parseInt(document.getElementById("bosskills").value) || 0;
      sessionXP += bosskills * 400 * multiplier;
      let solobosskills = parseInt(document.getElementById("solobosskills").value) || 0;
      sessionXP += solobosskills * 800 * multiplier;
      let banishpickups = parseInt(document.getElementById("banishpickups").value) || 0;
      sessionXP += banishpickups * 350 * multiplier;
      let eventBounty = parseInt(document.getElementById("eventBounty").value) || 0;
      if (eventBounty > 1) {
        eventBounty = 1;
        document.getElementById("eventBounty").value = 1;
      }
      let tokenpickups = parseInt(document.getElementById("Tokenpickups").value) || 0;
      if (eventBounty === 1 && tokenpickups > 2) {
        tokenpickups = 2;
        document.getElementById("Tokenpickups").value = 2;
      }
      sessionXP += tokenpickups * 500 * multiplier;
      sessionXP += eventBounty * 400;
      let eventEnvelopeXP = parseInt(document.getElementById("eventEnvelopeXP").value) || 0;
      if (eventEnvelopeXP < 0) {
        eventEnvelopeXP = 0;
        document.getElementById("eventEnvelopeXP").value = 0;
      } else if (eventEnvelopeXP > 50) {
        eventEnvelopeXP = 50;
        document.getElementById("eventEnvelopeXP").value = 50;
      }
      sessionXP += eventEnvelopeXP * 2000;
      let envelopeXP = parseInt(document.getElementById("envelopeXP").value) || 0;
      if (envelopeXP < 0) {
        envelopeXP = 0;
        document.getElementById("envelopeXP").value = 0;
      } else if (envelopeXP > 50) {
        envelopeXP = 50;
        document.getElementById("envelopeXP").value = 50;
      }
      sessionXP += envelopeXP * 1000;
      let extractionSeconds = 0;
      let extractionTimeStr = document.getElementById("extractionTime").value;
      if (extractionTimeStr) {
        let parts = extractionTimeStr.split(':');
        if (parts.length === 2) {
          let minutes = parseInt(parts[0]) || 0;
          let seconds = parseInt(parts[1]) || 0;
          extractionSeconds = minutes * 60 + seconds;
        } else if (parts.length === 1) {
          extractionSeconds = (parseInt(parts[0]) || 0) * 60;
        }
      }
      let extractionXP = (extractionSeconds > 0) ? Math.floor(extractionSeconds / 15) * 4 : 0;
      sessionXP += extractionXP * multiplier;
      
      let startLevel = parseInt(document.getElementById("startMatchLevel").value) || 1;
      let baselineXP = xpTable[startLevel - 1];
      
      if (startLevel === 50) {
        // When starting as level 50, no progression XP is applied.
        document.getElementById("estimatedLevel").textContent = 50;
        document.getElementById("xpToNextLevel").textContent = 0;
        document.getElementById("xpRemaining").textContent = 0;
        let bonusXP = sessionXP;
        let bloodlineEnvelopeXP = parseInt(document.getElementById("bloodlineEnvelopeXP").value) || 0;
        bonusXP += bloodlineEnvelopeXP * 500;
        let retireLevel50 = parseInt(document.getElementById("retireLevel50").value) || 0;
        bonusXP += retireLevel50 * 10000;
        document.getElementById("bonusBloodlineXP").textContent = bonusXP;
        document.getElementById("totalXP").textContent = Math.round(sessionXP);
      } else if (startLevel === 1) {
        let effectiveXP = baselineXP + sessionXP;
        if (effectiveXP < xpTable[49]) {
          // Not yet reached level 50
          let effectiveLevel = startLevel;
          for (let i = 0; i < xpTable.length; i++) {
            if (effectiveXP >= xpTable[i]) {
              effectiveLevel = i + 1;
            } else {
              break;
            }
          }
          document.getElementById("estimatedLevel").textContent = effectiveLevel;
          let xpToNext = effectiveLevel < xpTable.length ? xpTable[effectiveLevel] - effectiveXP : 0;
          document.getElementById("xpToNextLevel").textContent = Math.round(xpToNext * 10) / 10;
          let xpRemaining = xpTable[49] - effectiveXP;
          if (xpRemaining < 0) xpRemaining = 0;
          document.getElementById("xpRemaining").textContent = xpRemaining;
          let bonusXP = 0;
          if (document.getElementById("deathPenalty").checked) {
            bonusXP += sessionXP / 2;
          }
          if (effectiveLevel >= 4) bonusXP += 250;
          if (effectiveLevel >= 8) bonusXP += 250;
          if (effectiveLevel >= 13) bonusXP += 250;
          if (effectiveLevel >= 19) bonusXP += 500;
          if (effectiveLevel >= 26) bonusXP += 500;
          if (effectiveLevel >= 34) bonusXP += 500;
          if (effectiveLevel >= 42) bonusXP += 750;
          if (effectiveLevel >= 50) bonusXP += 1000;
          let bloodlineEnvelopeXP = parseInt(document.getElementById("bloodlineEnvelopeXP").value) || 0;
          bonusXP += bloodlineEnvelopeXP * 500;
          let retireLevel50 = parseInt(document.getElementById("retireLevel50").value) || 0;
          bonusXP += retireLevel50 * 10000;
          bonusXP = Math.max(0, bonusXP);
          document.getElementById("bonusBloodlineXP").textContent = bonusXP;
          document.getElementById("totalXP").textContent = Math.round(sessionXP);
        } else {
          // Effective XP reached or exceeded level 50
          document.getElementById("estimatedLevel").textContent = 50;
          document.getElementById("xpToNextLevel").textContent = 0;
          document.getElementById("xpRemaining").textContent = 0;
          let extraXP = effectiveXP - xpTable[49];
          let bonusXP = extraXP;
          if (document.getElementById("deathPenalty").checked) {
            bonusXP += sessionXP / 2;
          }
          // Add milestone bonus for reaching level 50
          bonusXP += 1000;
          let bloodlineEnvelopeXP = parseInt(document.getElementById("bloodlineEnvelopeXP").value) || 0;
          bonusXP += bloodlineEnvelopeXP * 500;
          let retireLevel50 = parseInt(document.getElementById("retireLevel50").value) || 0;
          bonusXP += retireLevel50 * 10000;
          bonusXP = Math.max(0, bonusXP);
          document.getElementById("bonusBloodlineXP").textContent = bonusXP;
          document.getElementById("totalXP").textContent = Math.round(sessionXP);
        }
      } else { // For start levels between 2 and 49
        let effectiveXP = baselineXP + sessionXP;
        let effectiveLevel = startLevel;
        for (let i = startLevel; i < xpTable.length; i++) {
          if (effectiveXP >= xpTable[i]) {
            effectiveLevel = i + 1;
          } else {
            break;
          }
        }
        if (effectiveLevel < 50) {
          document.getElementById("estimatedLevel").textContent = effectiveLevel;
          let xpToNext = xpTable[effectiveLevel] - effectiveXP;
          document.getElementById("xpToNextLevel").textContent = Math.round(xpToNext * 10) / 10;
          let xpRemaining = xpTable[49] - effectiveXP;
          if (xpRemaining < 0) xpRemaining = 0;
          document.getElementById("xpRemaining").textContent = xpRemaining;
          document.getElementById("totalXP").textContent = Math.round(sessionXP);
          let bonusXP = 0;
          let bloodlineEnvelopeXP = parseInt(document.getElementById("bloodlineEnvelopeXP").value) || 0;
          bonusXP += bloodlineEnvelopeXP * 500;
          let retireLevel50 = parseInt(document.getElementById("retireLevel50").value) || 0;
          bonusXP += retireLevel50 * 10000;
          bonusXP = Math.max(0, bonusXP);
          document.getElementById("bonusBloodlineXP").textContent = bonusXP;
        } else {
          document.getElementById("estimatedLevel").textContent = 50;
          document.getElementById("xpToNextLevel").textContent = 0;
          document.getElementById("xpRemaining").textContent = 0;
          let extraXP = effectiveXP - xpTable[49];
          let bonusXP = extraXP;
          let bloodlineEnvelopeXP = parseInt(document.getElementById("bloodlineEnvelopeXP").value) || 0;
          bonusXP += bloodlineEnvelopeXP * 500;
          let retireLevel50 = parseInt(document.getElementById("retireLevel50").value) || 0;
          bonusXP += retireLevel50 * 10000;
          bonusXP = Math.max(0, bonusXP);
          document.getElementById("bonusBloodlineXP").textContent = bonusXP;
          document.getElementById("totalXP").textContent = Math.round(sessionXP);
        }
      }
    }
    
    /* 11. Prestige XP Boost Functions */
    function updatePrestigeBoost() {
      var prestigeInput = document.getElementById("prestigeBoost");
      var p = parseInt(prestigeInput.value);
      if (isNaN(p)) {
        p = 1;
      }
      if (p < 1) {
        p = 1;
        prestigeInput.value = p;
      }
      if (p > 100) {
        p = 1;
        prestigeInput.value = p;
      }
      var indicator = document.getElementById("prestigeBoostIndicator");
      if (isPrestigeValid(p)) {
        indicator.innerHTML = '&nbsp;&nbsp;<span style="color:green;">&#10003; +10%</span>';
      } else {
        indicator.innerHTML = '';
      }
    }
    function isPrestigeValid(p) {
      return p >= 21 && (p % 10 !== 0 && p % 10 !== 5);
    }
    
    /* 12. Reset Fields (including resetting Start Match Level dropdown) */
    function resetFields() {
      document.querySelectorAll("input[type='number']").forEach(input => input.value = 0);
      document.querySelectorAll("input[type='text']").forEach(input => input.value = '');
      document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
        checkbox.checked = false;
        checkbox.disabled = false;
      });
      document.getElementById("eventEnvelopeXP").value = 0;
      document.getElementById("prestigeBoost").value = 1;
      document.getElementById("prestigeBoostIndicator").innerHTML = '';
      document.getElementById("extractionTime").disabled = false;
      document.getElementById("bloodlineRank").value = 1;
      document.getElementById("bonusBloodlineXP").textContent = '0';
      updateBloodlineXP();
      document.getElementById("estimatedBloodlineXP").textContent = '0';
      document.getElementById("xpToRank100").textContent = '99800';
      updateBloodlineXP();
      document.getElementById("totalXP").textContent = '0';
      document.getElementById("xpRemaining").textContent = '21100';
      document.getElementById("estimatedLevel").textContent = 1;
      document.getElementById("xpToNextLevel").textContent = 100;
      document.getElementById("bonusBloodlineXP").textContent = 0;
      document.getElementById("envelopeXP").value = 0;
      document.getElementById("bloodlineEnvelopeXP").value = 0;
      document.getElementById("retireLevel50").value = 0;
      document.getElementById("startingLevel50").checked = false;
      document.getElementById("startMatchLevel").value = 1;
      document.getElementById("eventBounty").disabled = false;
      let eventBountyInput = document.getElementById("eventBounty");
      let eventBountyButtons = eventBountyInput.parentElement.querySelectorAll("button");
      eventBountyButtons.forEach(btn => btn.disabled = false);
      const otherCheckboxes = [
        "dailyExtractBoost", "soloDuo", "soloTrio", "duoTrio", "cleanSweep",
        "Tokenpickups"
      ];
      enableElements(otherCheckboxes);
      document.getElementById("deathPenalty").checked = false;
      document.querySelectorAll("#creatures input[type='number']").forEach(input => input.value = 0);
      updateExtractionTimeState();
      updateTotal();
      updateReviveKillState();
    }
    
    /* 13. Theme Toggle */
    let themeIndex = 1;
    function tdnn() {
      document.body.classList.remove("light", "genuineLight");
      themeIndex = (themeIndex + 1) % 3;
      if (themeIndex === 1) {
        document.body.classList.add("light");
      } else if (themeIndex === 2) {
        document.body.classList.add("genuineLight");
      }
    }
    
    let savedExtractionTime = "";
    function updateExtractionTimeState() {
      document.getElementById("extractionTime").disabled = false;
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      resetFields();
      updateExtractionTimeState();
      document.getElementById("Tokenpickups").addEventListener("input", updateExtractionTimeState);
      document.getElementById("deathPenalty").addEventListener("change", updateExtractionTimeState);
      document.getElementById("eventBounty").addEventListener("input", updateExtractionTimeState);
    });
    
    /* FAQ Modal JavaScript */
    document.getElementById("faqButton").addEventListener("click", function() {
      document.getElementById("faqModal").style.display = "block";
    });
    document.getElementById("faqClose").addEventListener("click", function() {
      document.getElementById("faqModal").style.display = "none";
    });
    window.addEventListener("click", function(event) {
      if (event.target == document.getElementById("faqModal")) {
        document.getElementById("faqModal").style.display = "none";
      }
    });
    
    // Add a global keydown listener for the "R" key to trigger reset
    document.addEventListener('keydown', function(event) {
      if (event.key.toLowerCase() === 'r') {
        resetFields();
      }
    });
	
  </script>
</body>
</html>

